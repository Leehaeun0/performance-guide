# 애니메이션 최적화

브라우저 애니메이션 동작

→ 1초에 60장 (60fps, 16.67ms)

→ 애니메이션에서 쟁크 현상이 발생하는 경우도 60fps 보다 더 적게 화면을 그려 생기는 현상이다

→ 브라우저 렌더링 과정과 연관 있다

→ Main 스레드 차트에서 회색 점선의 주기가 16.7ms이다

Reflow

- 주요 렌더링 경로의 모든 단계를 재실행
- 브라우저 리소스를 많이 사용한다

Repaint

- 글자 색이나 배경 색 관련 색상이 변경될 경우
- CSSOM, 렌더 트리도 새로 생성하지만 레이아웃 단계는 실행하지 않는다

하드웨어 가속 (GPU 가속)

<aside>
💡 해당 요소를 별도의 레이어로 분리해 GPU에 처리함으로써 레이아웃, 페인트 단계를 건너뛴다

</aside>

- GPU는 그래픽 작업을 처리하기 위해 만들어진 것
    - 화면 그릴 때 활용하면 굉장히 빠르다
- transform, opacity 속성이 요소를 별도의 레이어로 분리해 GPU로 보낸다
- 분리된 레이어는 GPU에 의해 처리되어 레이아웃, 페인트 단계 없이 화면상의 요소의 스타일을 변경할 수 있다

TRANSFORM의 여러 속성들

translate(): 변화가 일어나는 순간 레이어 분리

translate3d(), scale3d() 같은 3d 속성들 또는 will-change 속성: 처음부터 레이어를 분리해서 변화에 더욱 빠르게 대처 가능

주의: 레이어가 너무 많아지면 메모리를 많이 사용하게 되므로 주의

# 컴포넌트 사전 로딩

지연 로딩의 단점

- 지연 로딩: 최초 페이지 로드할 때 필요없는 코드가 번들에 포함되지 않아 로드할 파일 크기가 작아지고 초기 로딩 속도나 자바스크립트 실행 타이밍이 빨라진다
- 단점: 모달 코드를 분리했기 때문에 모달을 띄울 때 네트워크를 통해 코드를 새로 로드해야 하며 로드가 완료되기까지 기다려야 함

컴포넌트 사전 로딩 타이밍 (모달)

- 마우스 커서를 버튼에 올려놓는다
    - 버튼을 클릭하기까지 300~600ms 정도의 시간 차가 존재하므로 새 파일을 로드하기에 충분하다
- 클릭

만약 컴포넌트 크기가 크다면 1초 또는 그 이상의 시간이 필요하게 된다

⇒ 마우스를 올리기 전에 먼저 파일을 로드해야 한다

⇒ 마운트 완료 후 초기 페이지 로드 시 적용

⇒ Network 탭을 보면 초기 페이지 로드에 필요한 파일을 우선 다운로드하고 페이지 코드가 완료된 후에 해당 코드를 다운로드한다

# 이미지 사전 로딩

- 자바스크립트의 Image 객체를 이용해 사전 로딩을 적용
- 가장 중요하다고 판단되는 컴포넌트별 대표 이미지 정도만 로딩하기
- 섬네일 이미지까지 사전 로딩을 할 수 있지만 그만큼 리소스를 많이 사용해서 다른 성능 문제를 야기할 수도 있음